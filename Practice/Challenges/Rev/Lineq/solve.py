from z3 import *

buf = [BitVec(f"f_{i}", 8) for i in range(32)]
tmp = [BitVec(f"f_{i}", 8) for i in range(32)]
known = "ECW{".encode()
s = Solver()

for idx, val in enumerate(known):
    s.add(buf[idx] == val)

s.add(buf[-1] == 125)

s.add(-26 * (buf[22] ^ 0x40) + -121 * (buf[14] ^ 0x40) + -132 * (buf[21] ^ 0x40)+ 236 * (buf[20] ^ 0x40) - ((buf[21] ^ 0x40) << 6) == -3241)
s.add(162 * (buf[15] ^ 0x6B) + -74 * (buf[17] ^ 0x6B) + 220 * (buf[8] ^ 0x6B) + 89 * (buf[6] ^ 0x6B) + 12 * (buf[5] ^ 0x6B) == 23265)
s.add(191 * (buf[27] ^ 0xF7) + 199 * (buf[14] ^ 0xF7) + -234 * (buf[5] ^ 0xF7) + -193 * (buf[30] ^ 0xF7) - 96 * (buf[9] ^ 0xF7) == -22802)
s.add(106 * (buf[7] ^ 0x6E) + 136 * (buf[5] ^ 0x6E) + -128 * (buf[11] ^ 0x6E) + 37 * (buf[12] ^ 0x6E) == 20496)
s.add(247 * (buf[11] ^ 0x24) + -250 * (buf[12] ^ 0x24) + 215 * (buf[28] ^ 0x24) - 123 * (buf[4] ^ 0x24) - 4 * (buf[13] ^ 0x24) == 14601)
s.add(133 * (buf[26] ^ 0x54) + -36 * (buf[8] ^ 0x54) + -148 * (buf[11] ^ 0x54) + -134 * (buf[24] ^ 0x54) + 32 * (buf[16] ^ 0x54) == -9273)
s.add(-164 * (buf[13] ^ 1) + -5 * (buf[7] ^ 1) + -212 * (buf[17] ^ 1) + 313 * (buf[22] ^ 1) == 4980)
s.add(-222 * (buf[27] ^ 0xA7) + 129 * (buf[4] ^ 0xA7) + 210 * (buf[19] ^ 0xA7) - 216 * (buf[15] ^ 0xA7) == -10035)
s.add(142 * (buf[10] ^ 0x27) + 79 * (buf[21] ^ 0x27) + -54 * (buf[21] ^ 0x27) - 182 * (buf[26] ^ 0x27) + 185 * (buf[11] ^ 0x27) == 14150)
s.add(-182 * (buf[24] ^ 0x8D) + 113 * (buf[11] ^ 0x8D) + 38 * (buf[11] ^ 0x8D) - 21 * (buf[21] ^ 0x8D) + 198 * (buf[22] ^ 0x8D) == 22412)
s.add(366 * (buf[20] ^ 0xC8) + -202 * (buf[27] ^ 0xC8) - 91 * (buf[13] ^ 0xC8) - 58 * (buf[18] ^ 0xC8) == 13796)
s.add(246 * (buf[24] ^ 0x6D) + 3 * (buf[21] ^ 0x6D) + -85 * (buf[5] ^ 0x6D) + -124 * (buf[13] ^ 0x6D) + 204 * (buf[27] ^ 0x6D) == 14906)
s.add(-93 * (buf[20] ^ 0x66) + -75 * (buf[26] ^ 0x66) + 243 * (buf[16] ^ 0x66) + 196 * (buf[6] ^ 0x66) - 231 * (buf[29] ^ 0x66) == -18839)
s.add(125 * (buf[13] ^ 0x1F) + -61 * (buf[14] ^ 0x1F) + -106 * (buf[25] ^ 0x1F) + -253 * (buf[21] ^ 0x1F) + 204 * (buf[22] ^ 0x1F) == 1303)
s.add(30 * (buf[30] ^ 0x2B) + 178 * (buf[9] ^ 0x2B) + 143 * (buf[17] ^ 0x2B) + 147 * (buf[13] ^ 0x2B) - 207 * (buf[15] ^ 0x2B) == 17917)
s.add(-159 * (buf[19] ^ 0xD) + -106 * (buf[21] ^ 0xD) + 123 * (buf[19] ^ 0xD) - 100 * (buf[30] ^ 0xD) - 90 * (buf[24] ^ 0xD) == -32530)
s.add(-31 * (buf[23] ^ 0x1E) + -53 * (buf[26] ^ 0x1E) + 246 * (buf[12] ^ 0x1E) + 36 * (buf[9] ^ 0x1E) + 14 * (buf[21] ^ 0x1E) == 11059)
s.add(149 * (buf[10] ^ 0x1F) + 6 * (buf[17] ^ 0x1F) + 124 * (buf[29] ^ 0x1F) + 113 * (buf[8] ^ 0x1F) + 138 * (buf[7] ^ 0x1F) == 25933)
s.add(-166 * (buf[4] ^ 0x23) + 232 * (buf[19] ^ 0x23) + -26 * (buf[24] ^ 0x23) - 50 * (buf[27] ^ 0x23) - 73 * (buf[6] ^ 0x23) == -6113)
s.add(30 * (buf[24] ^ 0x87) + -124 * (buf[23] ^ 0x87) + 212 * (buf[30] ^ 0x87) + 9 * (buf[18] ^ 0x87) - 70 * (buf[28] ^ 0x87) == 28110)
s.add(215 * (buf[8] ^ 0xE9) + -146 * (buf[9] ^ 0xE9) + -174 * (buf[26] ^ 0xE9) + -99 * (buf[17] ^ 0xE9) + 32 * (buf[24] ^ 0xE9) == -23702)
s.add(220 * (buf[8] ^ 0x3E) + -9 * (buf[19] ^ 0x3E) + 10 * (buf[26] ^ 0x3E) - 16 * (buf[11] ^ 0x3E) - 216 * (buf[23] ^ 0x3E) == -1710)
s.add(-114 * (buf[4] ^ 0xDF) + 80 * (buf[11] ^ 0xDF) + -34 * (buf[4] ^ 0xDF) + 67 * (buf[27] ^ 0xDF) + 95 * (buf[25] ^ 0xDF) == 24220)
s.add(-219 * (buf[14] ^ 0x6A) + 110 * (buf[23] ^ 0x6A) - 169 * (buf[17] ^ 0x6A) + 82 * (buf[4] ^ 0x6A) + 69 * (buf[19] ^ 0x6A) == -10253)
s.add(110 * (buf[4] ^ 0x1B) + 76 * (buf[23] ^ 0x1B) + 32 * (buf[11] ^ 0x1B) + -152 * (buf[29] ^ 0x1B) + 215 * (buf[27] ^ 0x1B) == 21086)
s.add(147 * (buf[18] ^ 1) + -205 * (buf[17] ^ 1) + -135 * (buf[7] ^ 1) + -158 * (buf[23] ^ 1) - 17 * (buf[4] ^ 1) == -20786)
s.add(255 * (buf[8] ^ 0xD) - 241 * (buf[16] ^ 0xD) + 81 * (buf[9] ^ 0xD) - 18 * (buf[21] ^ 0xD) + 47 * (buf[5] ^ 0xD) == -3973)


for i in buf:
    s.add(i > 0x20)
    s.add(i < 0x7f)

if s.check() == sat:
    m = s.model()

    for i in range(len(buf)):
        print(chr(m[buf[i]].as_long()), end='')
    
